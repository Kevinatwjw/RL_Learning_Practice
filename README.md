# RL_Learning_Practice
è¯¥ä»“åº“æ˜¯ç”¨æˆ·ç”¨äºå­¦ä¹ å¼ºåŒ–å­¦ä¹ çš„ä»£ç ï¼Œä»£ç å‚è€ƒä¸ºCSDNåšä¸»äº‘ç«¯FFFå’Œã€ŠåŠ¨æ‰‹å­¦ä¹ å¼ºåŒ–å­¦ä¹ ã€‹ã€‚
# 1.Cliff Walking Problem ğŸ§—â€â™‚ï¸

ä¸€ä¸ªåŸºäº **OpenAI Gym** çš„å¯è§†åŒ– Cliff-Walking ç¯å¢ƒ + ç»å…¸è¡¨æ ¼å‹å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼ˆSARSA / Expected SARSAï¼‰çš„æ•™å­¦ & å®éªŒä»“åº“ã€‚

* **ç¯å¢ƒå®Œå…¨è‡ªç ”**ï¼šæ”¯æŒä»»æ„ç½‘æ ¼å°ºå¯¸ã€å¯è‡ªç”±åˆ‡æ¢ `human / rgb_array` æ¸²æŸ“æ¨¡å¼ã€‚
* **å®æ—¶å¯è§†åŒ–**ï¼šä»·å€¼å‡½æ•°ç”¨é¢œè‰²æ·±æµ…æ¸²æŸ“ï¼Œè´ªå¿ƒç­–ç•¥ç”¨ç»¿è™šçº¿ç®­å¤´æ¸²æŸ“ã€‚
* **å¤šç§äº¤äº’æ–¹å¼**ï¼šé”®ç›˜æ‰‹åŠ¨æ§åˆ¶ã€éšæœºåŠ¨ä½œæµ‹è¯•ã€è„šæœ¬è‡ªåŠ¨è®­ç»ƒã€‚
* **ç®—æ³•å³æ’å³ç”¨**ï¼šè¡¨æ ¼ç‰ˆ SARSAã€Expected SARSAï¼ˆæ”¯æŒ on-policy / off-policy + ç»éªŒå›æ”¾ï¼‰ã€‚

> ğŸ“š ä»£ç é£æ ¼ä¸æ³¨é‡Šçš†é¢å‘ RL åˆå­¦è€…ï¼Œé€‚åˆä½œä¸ºè¯¾ç¨‹ / è¯»ä¹¦ä¼šé…å¥— Demoã€‚

---

## ç›®å½•ç»“æ„

```text
RL_Learning_Practice/
â”œâ”€â”€ Cliff_Walking_Problem/
â”‚   â”œâ”€â”€ CliffWalking/            # ç¯å¢ƒåŒ…
â”‚   â”‚   â”œâ”€â”€ envs/
â”‚   â”‚   â”‚   â””â”€â”€ GridWorld.py     # CliffWalkingEnv å®ç°
â”‚   â”‚   â””â”€â”€ wrappers/
â”‚   â”‚       â””â”€â”€ Hashposotion.py  # è§‚æµ‹åŒ…è£…å™¨ï¼šäºŒç»´åæ ‡ â†’ ä¸€ç»´å“ˆå¸Œ
â”‚   â”œâ”€â”€ EnvTest_ManualControl.py # é”®ç›˜æ§åˆ¶ Demo
â”‚   â”œâ”€â”€ EnvTest_RandomAction.py  # éšæœºåŠ¨ä½œ Demo
â”‚   â”œâ”€â”€ RL_Solver_Class.py       # Solver åŸºç±» + SARSA / Expected SARSA
â”‚   â”œâ”€â”€ RL_Sarsa.py              # SARSA è®­ç»ƒè„šæœ¬
â”‚   â”œâ”€â”€ RL_ExpectedSarsa.py      # Expected SARSA è®­ç»ƒè„šæœ¬
â”‚   â”œâ”€â”€ *.ipynb                  # æ•™ç¨‹ / è¯•éªŒç¬”è®°æœ¬
â””â”€â”€ README.md                    # æœ¬æ–‡ä»¶
```

---

## ä¾èµ–ç¯å¢ƒ

æœ¬ä»“åº“æš‚æœªæä¾› `requirements.txt`ï¼Œè¯·æŒ‰ä¸‹è¡¨æ‰‹åŠ¨å®‰è£…**æœ€å°è¿è¡Œä¾èµ–**ï¼š

| åº“          |   ç‰ˆæœ¬å»ºè®®   | è¯´æ˜                       |
| :--------- | :------: | :----------------------- |
| Python     |   â‰¥ 3.8  | æ¨èä½¿ç”¨ Conda è™šæ‹Ÿç¯å¢ƒ          |
| gym        | \~= 0.26 | `gym.utils.play` ä»åœ¨æ­¤ç‰ˆæœ¬ä¿ç•™ |
| numpy      |  â‰¥ 1.24  | æ•°å€¼è®¡ç®—                     |
| pygame     |   â‰¥ 2.0  | å›¾å½¢æ¸²æŸ“                     |
| matplotlib |   â‰¥ 3.7  | è®­ç»ƒæ›²çº¿ç»˜åˆ¶                   |
| tqdm       |  â‰¥ 4.66  | è¿›åº¦æ¡                      |

> å…¶ä»–åŒ…ï¼ˆå¦‚ `jupyter`ï¼‰ä»…åœ¨ Notebook åœºæ™¯ä¸‹éœ€è¦ï¼Œå¯æŒ‰éœ€å®‰è£…ã€‚

### ä¸€é”®å®‰è£…

```bash
conda create -n cliffwalk python=3.8 -y
conda activate cliffwalk
pip install "gym~=0.26" pygame numpy matplotlib tqdm
```

---

## å¿«é€Ÿä¸Šæ‰‹

### 1ï¸âƒ£ é”®ç›˜ä½“éªŒç¯å¢ƒ

```bash
python EnvTest_ManualControl.py
```

* ä½¿ç”¨ **â†‘ â†“ â† â†’** ç§»åŠ¨ä»£ç†ï¼›
* ç©ºæ ¼æˆ–å…¶ä»–é”®è§¦å‘ `noop`ï¼ˆä¿æŒä¸åŠ¨ï¼‰ï¼›
* ç»ˆç«¯å®æ—¶æ‰“å°å¥–åŠ±ä¸ä¿¡æ¯ã€‚

### 2ï¸âƒ£ éšæœºåŠ¨ä½œç¤ºä¾‹

```bash
python EnvTest_RandomAction.py
```

è„šæœ¬ä¼šéšæœºé‡‡æ ·åŠ¨ä½œï¼Œå¹¶å°†éšæœºç”Ÿæˆçš„ä»·å€¼å‡½æ•° & ç­–ç•¥æ¸²æŸ“åˆ°çª—å£ã€‚

### 3ï¸âƒ£ è®­ç»ƒ SARSA

```bash
python RL_Sarsa.py
```

è®­ç»ƒè¿‡ç¨‹ä¸­ï¼š

* Pygame çª—å£å®æ—¶æ˜¾ç¤º **ä»·å€¼å‡½æ•° + è´ªå¿ƒç­–ç•¥**ï¼›
* ç»ˆç«¯è¾“å‡ºæ¯ 5 ä¸ª episode çš„å¹³å‡å›æŠ¥ï¼›
* ç»“æŸåè‡ªåŠ¨ç»˜åˆ¶å›æŠ¥æ›²çº¿ã€‚

### 4ï¸âƒ£ è®­ç»ƒ Expected SARSA

```bash
python RL_ExpectedSarsa.py
```

æ”¯æŒ on-policyï¼ˆé»˜è®¤ï¼‰ä¸ off-policyï¼ˆä¼ å…¥ `batch_size>0`ï¼‰ä¸¤ç§æ¨¡å¼ï¼Œè„šæœ¬é¡¶éƒ¨å¯ä¿®æ”¹è¶…å‚æ•°ã€‚

---

## ç®—æ³•ç®€ä»‹

| ç®—æ³•             | æ›´æ–°ç›®æ ‡                                        | ç‰¹ç‚¹            |
| :------------- | :------------------------------------------ | :------------ |
| SARSA          | $Q(s,a) â† Q(s,a)+Î±[r + Î³Q(s',a') âˆ’ Q(s,a)]$ | on-policyã€æ˜“å®ç° |
| Expected SARSA | $r + Î³\mathbb{E}_{a'\simÏ€}[Q(s',a')]$       | ç›®æ ‡æ›´ç¨³å®šï¼Œå¯æ‰©å±•ç»éªŒå›æ”¾ |

è¯¦è§ [`RL_Solver_Class.py`](Cliff_Walking_Problem/RL_Solver_Class.py)ã€‚

---

## å¯è§†åŒ–è¯´æ˜

* **é¢œè‰²æ·±æµ…**ï¼šçŠ¶æ€ä»·å€¼ $V(s)$ï¼Œç”±çº¢æµ… â†’ æ·±è¡¨ç¤ºä»·å€¼è¶Šé«˜ï¼›
* **ç»¿è™šçº¿ç®­å¤´**ï¼šå½“å‰è´ªå¿ƒç­–ç•¥åŠ¨ä½œï¼›
* **è“è‰²åœ†ç‚¹**ï¼šæ™ºèƒ½ä½“å®æ—¶ä½ç½®ï¼›
* `rgb_array` æ¨¡å¼ä¸‹è¿”å›åŸå§‹ RGB å¸§ï¼Œä¾¿äºåç»­æ¥å…¥ CNNã€‚

<p align="center">
  <img src="docs/demo.gif" width="600" alt="demo" />
</p>

---

## Roadmap ğŸš§

* [ ] Q-Learning / Double Q-Learning
* [ ] Dyna-Q
* [ ] å‡½æ•°é€¼è¿‘ï¼ˆDQN / Sarsa(Î»)ï¼‰
* [ ] è‡ªåŠ¨ç”Ÿæˆ `requirements.txt`

---

## å‚è€ƒèµ„æ–™

* Sutton & Barto. *Reinforcement Learning: An Introduction*
* [OpenAI Gym æ–‡æ¡£](https://www.gymlibrary.dev/)

---

## License

MIT Â© 2025
